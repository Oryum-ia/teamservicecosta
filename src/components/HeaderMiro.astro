---
// Header Component - Miro Style
---

<header class="header">
  <div class="container">
    <nav class="nav">
      <a href="/" class="nav-brand">
        <img src="/images/logo de la empresa/logo.jpg" alt="Team Service Costa - Servicio Técnico Especializado" class="brand-logo-img" />
      </a>

      <button class="nav-toggle" aria-label="Toggle menu" aria-expanded="false">
        <span class="hamburger"></span>
      </button>

      <ul class="nav-menu" role="list">
        <!-- Logo para móvil -->
        <li class="mobile-logo-container">
          <img src="/images/logo de la empresa/logo.jpg" alt="Team Service Costa" class="mobile-logo" />
          <span class="mobile-brand-name">Team Service Costa</span>
        </li>

        <!-- Equipos Kärcher Dropdown -->
        <li class="nav-item-dropdown">
          <button class="nav-link dropdown-toggle" aria-expanded="false">
            Equipos Kärcher
            <svg class="dropdown-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.5 4.5L6 8L9.5 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <ul class="dropdown-menu products-menu">
            <li><a href="/tienda?category=hogar" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                <polyline points="9 22 9 12 15 12 15 22"></polyline>
              </svg>
              Hogar
            </a></li>
            <li><a href="/tienda?category=profesional" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect>
                <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                <line x1="8" y1="2" x2="16" y2="2"></line>
              </svg>
              Profesional
            </a></li>
            <li><a href="/tienda?category=repuestos" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path>
                <circle cx="12" cy="12" r="3"></circle>
                <line x1="12" y1="12" x2="12" y2="15"></line>
              </svg>
              Repuestos
            </a></li>
            <li><a href="/tienda?category=accesorios" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"></path>
              </svg>
              Accesorios
            </a></li>
          </ul>
        </li>

        <!-- Herramientas Makita Dropdown -->
        <li class="nav-item-dropdown">
          <button class="nav-link dropdown-toggle" aria-expanded="false">
            Herramientas Makita
            <svg class="dropdown-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.5 4.5L6 8L9.5 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <ul class="dropdown-menu makita-menu">
            <li><a href="/tienda?brand=makita&category=industrial" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="20" width="20" height="2"></rect>
                <rect x="4" y="12" width="4" height="8"></rect>
                <rect x="10" y="8" width="4" height="12"></rect>
                <rect x="16" y="4" width="4" height="16"></rect>
                <path d="M2 12l5-5 4 4 7-7"></path>
              </svg>
              Industrial
            </a></li>
            <li><a href="/tienda?brand=makita&category=profesional" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 7h-4V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"></path>
                <path d="M12 12h.01"></path>
              </svg>
              Profesional
            </a></li>
          </ul>
        </li>

        <!-- Servicios Dropdown -->
        <li class="nav-item-dropdown">
          <button class="nav-link dropdown-toggle" aria-expanded="false">
            Servicios
            <svg class="dropdown-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.5 4.5L6 8L9.5 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <ul class="dropdown-menu services-menu">
            <li><a href="/#servicios" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
              </svg>
              Servicio Técnico Autorizado
            </a></li>
            <li><a href="/#servicios" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
                <polyline points="11 14 12 15 15 12"></polyline>
              </svg>
              Mantenimiento Preventivo
            </a></li>
            <li><a href="/#servicios" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                <polyline points="9 12 11 14 15 10"></polyline>
              </svg>
              Repuestos Originales
            </a></li>
            <li class="dropdown-divider"></li>
            <li><a href="/estado-producto" class="dropdown-link dropdown-link-featured">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                <circle cx="12" cy="10" r="3"></circle>
              </svg>
              Rastrear mi Equipo
            </a></li>
          </ul>
        </li>

        <!-- Sobre Nosotros Dropdown -->
        <li class="nav-item-dropdown">
          <button class="nav-link dropdown-toggle" aria-expanded="false">
            Nosotros
            <svg class="dropdown-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.5 4.5L6 8L9.5 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <ul class="dropdown-menu about-menu">
            <li><a href="/quienes-somos" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87m-4-12a4 4 0 0 1 0 7.75"></path>
              </svg>
              Quiénes Somos
            </a></li>
            <li><a href="/quienes-somos#mision-vision" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <circle cx="12" cy="12" r="6"></circle>
                <circle cx="12" cy="12" r="2"></circle>
              </svg>
              Misión y Visión
            </a></li>
            <li><a href="/quienes-somos#valores" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
              </svg>
              Nuestros Valores
            </a></li>
            <li class="dropdown-divider"></li>
            <li><a href="/labor-social" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
              </svg>
              Labor Social
            </a></li>
            <li><a href="/nuestros-clientes" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              Nuestros Clientes
            </a></li>
          </ul>
        </li>

        <!-- Soporte y Contacto -->
        <li class="nav-item-dropdown">
          <button class="nav-link dropdown-toggle" aria-expanded="false">
            Soporte
            <svg class="dropdown-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M2.5 4.5L6 8L9.5 4.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <ul class="dropdown-menu support-menu">
            <li><a href="/#contacto" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              </svg>
              Contacto
            </a></li>
            <li><a href="/pqr" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
              PQR
            </a></li>
            <li><a href="/encuesta" class="dropdown-link">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 11H3v2h6m1 0a1 1 0 102 0m-3 0a1 1 0 112 0m-1-4a1 1 0 102 0m-1 0a1 1 0 10-2 0"></path>
                <path d="M21 12h-6m-1 0a1 1 0 10-2 0m3 0a1 1 0 11-2 0m1-4a1 1 0 10-2 0m1 0a1 1 0 102 0"></path>
                <rect x="3" y="4" width="18" height="16" rx="2"></rect>
              </svg>
              Encuesta de Satisfacción
            </a></li>
            <li class="dropdown-divider"></li>
            <li><a href="/#contacto" class="dropdown-link dropdown-link-featured">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
              </svg>
              ¿Necesitas Ayuda?
            </a></li>
          </ul>
        </li>
      </ul>

      <div class="nav-actions">
        <button id="cart-button" class="btn-cart" aria-label="Abrir carrito">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          <span id="cart-badge" class="cart-badge">0</span>
        </button>
        <a href="/estado-producto" class="btn-login">Estado de producto</a>
      </div>
    </nav>
  </div>
</header>

<style>
  .header {
    background: var(--color-white);
    border-bottom: 1px solid var(--color-gray-200);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    backdrop-filter: blur(12px);
    background: rgba(255, 255, 255, 0.95);
    transform: translateY(0);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .header.header-hidden {
    transform: translateY(-100%);
  }

  .header.header-scrolled {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    background: rgba(255, 255, 255, 0.98);
  }

  .header::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--color-primary) 0%, var(--color-accent) 100%);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
  }

  .header:hover::after {
    transform: scaleX(1);
  }

  .container {
    max-width: var(--container-max-width);
    margin: 0 auto;
    padding: 0 var(--container-padding);
  }

  .nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 60px;
    gap: var(--spacing-6);
  }

  /* Brand Logo */
  .nav-brand {
    display: flex;
    align-items: center;
    text-decoration: none;
    flex-shrink: 0;
    transition: opacity var(--transition-fast);
  }

  .nav-brand:hover {
    opacity: 0.9;
  }

  .brand-logo-img {
    height: 50px;
    width: auto;
    object-fit: contain;
    display: block;
  }

  /* Navigation Menu */
  .nav-menu {
    display: flex;
    list-style: none;
    gap: var(--spacing-2);
    margin: 0;
    padding: 0;
    flex: 1;
    justify-content: center;
  }

  .nav-link {
    color: var(--color-gray-700);
    font-weight: var(--font-medium);
    font-size: var(--text-sm);
    text-decoration: none;
    padding: var(--spacing-2) var(--spacing-4);
    border-radius: var(--radius-lg);
    transition: all var(--transition-fast);
    white-space: nowrap;
  }

  .nav-link:hover {
    color: var(--color-black);
    background: #FFD700;
  }

  /* Dropdown Menus */
  .nav-item-dropdown {
    position: relative;
  }

  .dropdown-toggle {
    display: flex;
    align-items: center;
    gap: 4px;
    background: none;
    border: none;
    cursor: pointer;
  }

  .dropdown-icon {
    transition: transform 0.3s ease;
  }

  .dropdown-toggle[aria-expanded="true"] .dropdown-icon {
    transform: rotate(180deg);
  }

  .dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    min-width: 200px;
    background: white;
    border-radius: var(--radius-lg);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    padding: var(--spacing-2);
    margin-top: var(--spacing-2);
    list-style: none;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1000;
  }

  .nav-item-dropdown:hover .dropdown-menu,
  .dropdown-toggle[aria-expanded="true"] + .dropdown-menu {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .dropdown-link {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-3) var(--spacing-4);
    color: var(--color-gray-700);
    text-decoration: none;
    border-radius: var(--radius-md);
    transition: all 0.2s ease;
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    background: none;
    border: none;
    width: 100%;
    text-align: left;
    cursor: pointer;
  }

  .dropdown-link:hover {
    background: #FFD700;
    color: #1a1a2e;
  }

  /* Dropdown sections and headers */
  .dropdown-section {
    list-style: none;
  }

  .dropdown-section-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
    padding: var(--spacing-2) var(--spacing-4);
    color: #1a1a2e;
    font-weight: var(--font-bold);
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--spacing-1);
  }

  .dropdown-section-header svg {
    color: #FFD700;
  }

  .makita-header svg {
    color: #00BCD4;
  }

  .dropdown-subsection {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .dropdown-divider {
    height: 1px;
    background: var(--color-gray-200);
    margin: var(--spacing-2) 0;
    list-style: none;
  }

  .dropdown-link-featured {
    background: linear-gradient(135deg, #FFD700 0%, #FFC700 100%);
    color: #1a1a2e;
    font-weight: var(--font-bold);
    margin-top: var(--spacing-2);
  }

  .dropdown-link-featured:hover {
    background: linear-gradient(135deg, #FFC700 0%, #FFB700 100%);
    transform: translateX(4px);
  }

  .dropdown-link svg {
    flex-shrink: 0;
    margin-right: var(--spacing-2);
    color: var(--color-gray-500);
    transition: color 0.2s ease;
  }

  .dropdown-link:hover svg {
    color: #1a1a2e;
  }

  /* Specific menu widths for better organization */
  .products-menu {
    min-width: 280px;
  }

  .services-menu {
    min-width: 260px;
  }

  .about-menu {
    min-width: 240px;
  }

  .support-menu {
    min-width: 260px;
  }

  /* Makita menu with brand colors */
  .makita-menu .dropdown-link:hover {
    background: #00BCD4;
    color: white;
  }


  /* Actions */
  .nav-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-3);
    flex-shrink: 0;
  }

  .btn-login {
    color: var(--color-gray-700);
    font-weight: var(--font-semibold);
    font-size: var(--text-sm);
    text-decoration: none;
    padding: var(--spacing-2) var(--spacing-4);
    border-radius: var(--radius-lg);
    transition: all var(--transition-fast);
    white-space: nowrap;
  }

  .btn-login:hover {
    color: var(--color-black);
    background: var(--color-gray-100);
  }

  .btn-cart {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    background: var(--color-gray-100);
    border: none;
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--transition-fast);
    color: var(--color-gray-700);
  }

  .btn-cart:hover {
    background: var(--color-gray-200);
    color: var(--color-black);
  }

  .cart-badge {
    position: absolute;
    top: -6px;
    right: -6px;
    min-width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #ef4444;
    color: white;
    font-size: 11px;
    font-weight: var(--font-bold);
    border-radius: var(--radius-full);
    border: 2px solid white;
    padding: 0 4px;
    opacity: 0;
    transform: scale(0);
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
  }

  .cart-badge.has-items {
    opacity: 1;
    transform: scale(1);
    animation: cartBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), cartPulse 2s infinite 1s;
  }

  @keyframes cartBounce {
    0% { 
      transform: scale(0) rotate(-180deg); 
      opacity: 0;
    }
    50% { 
      transform: scale(1.3) rotate(-90deg); 
      opacity: 0.8;
    }
    100% { 
      transform: scale(1) rotate(0deg); 
      opacity: 1;
    }
  }

  @keyframes cartPulse {
    0%, 100% { 
      transform: scale(1);
      box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
    }
    50% { 
      transform: scale(1.1);
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.5);
    }
  }


  /* Mobile Toggle Button */
  .nav-toggle {
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 44px;
    height: 44px;
    background: var(--color-gray-100);
    border: none;
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: background var(--transition-fast);
    padding: 0;
  }

  .nav-toggle:hover {
    background: var(--color-gray-200);
  }

  .hamburger {
    width: 20px;
    height: 2px;
    background: var(--color-black);
    position: relative;
    transition: all var(--transition-base);
  }

  .hamburger::before,
  .hamburger::after {
    content: '';
    position: absolute;
    width: 20px;
    height: 2px;
    background: var(--color-black);
    transition: all var(--transition-base);
  }

  .hamburger::before {
    top: -6px;
  }

  .hamburger::after {
    bottom: -6px;
  }

  .nav-toggle[aria-expanded="true"] .hamburger {
    background: transparent;
  }

  .nav-toggle[aria-expanded="true"] .hamburger::before {
    top: 0;
    transform: rotate(45deg);
  }

  .nav-toggle[aria-expanded="true"] .hamburger::after {
    bottom: 0;
    transform: rotate(-45deg);
  }

  /* Responsive Design */
  @media (max-width: 968px) {
    .nav {
      height: 56px;
    }

    .nav-toggle {
      display: flex;
    }

    .nav-menu {
      display: none;
      position: absolute;
      top: 56px;
      left: 0;
      right: 0;
      flex-direction: column;
      background: linear-gradient(135deg, #1a1a2e 0%, #2d2d44 100%);
      border-bottom: 3px solid #FFD02F;
      padding: var(--spacing-6) var(--spacing-4) var(--spacing-4);
      gap: var(--spacing-2);
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.2);
      max-height: calc(100vh - 56px);
      overflow-y: auto;
    }

    .nav-menu.active {
      display: flex;
    }

    /* Logo móvil */
    .mobile-logo-container {
      display: flex;
      align-items: center;
      gap: var(--spacing-3);
      padding: var(--spacing-4) var(--spacing-3);
      margin-bottom: var(--spacing-4);
      border-bottom: 2px solid rgba(255, 208, 47, 0.3);
    }

    .mobile-logo {
      width: 50px;
      height: 50px;
      border-radius: var(--radius-lg);
      object-fit: cover;
      border: 2px solid #FFD02F;
    }

    .mobile-brand-name {
      font-size: var(--text-lg);
      font-weight: var(--font-bold);
      color: #FFD02F;
    }

    .nav-link {
      padding: var(--spacing-3);
      width: 100%;
      text-align: left;
      color: rgba(255, 255, 255, 0.9);
      border-radius: var(--radius-md);
      transition: all 0.3s;
    }

    .nav-link:hover,
    .nav-link:focus {
      background: rgba(255, 208, 47, 0.1);
      color: #FFD02F;
    }

    .dropdown-toggle {
      color: rgba(255, 255, 255, 0.9);
    }

    .dropdown-toggle:hover {
      background: rgba(255, 208, 47, 0.1);
      color: #FFD02F;
    }

    .dropdown-menu {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 208, 47, 0.2);
    }

    .dropdown-link {
      color: rgba(255, 255, 255, 0.85);
    }

    .dropdown-link:hover {
      background: rgba(255, 208, 47, 0.15);
      color: #FFD02F;
    }

    .btn-login {
      display: none;
    }

    /* Mostrar logo en móvil */
    .mobile-logo-container {
      display: flex;
    }

    .btn-cart {
      width: 40px;
      height: 40px;
    }

    .brand-logo-img {
      height: 45px;
    }
  }

  /* Ocultar logo móvil en desktop */
  .mobile-logo-container {
    display: none;
  }

  @media (max-width: 640px) {
    .nav {
      height: 52px;
    }

    .nav-toggle {
      width: 36px;
      height: 36px;
    }

    .brand-logo-img {
      height: 40px;
    }
  }
</style>

<script>
  // Use JavaScript instead of TypeScript syntax
  const navToggle = document.querySelector('.nav-toggle');
  const navMenu = document.querySelector('.nav-menu');

  if (navToggle && navMenu) {
    navToggle.addEventListener('click', () => {
      const isExpanded = navToggle.getAttribute('aria-expanded') === 'true';
      navToggle.setAttribute('aria-expanded', (!isExpanded).toString());
      navMenu.classList.toggle('active');
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      const target = e.target;
      if (target && target instanceof Element && !navToggle.contains(target) && !navMenu.contains(target)) {
        navToggle.setAttribute('aria-expanded', 'false');
        navMenu.classList.remove('active');
      }
    });

    // Close menu when clicking on a link
    const navLinks = navMenu.querySelectorAll('.nav-link');
    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        navToggle.setAttribute('aria-expanded', 'false');
        navMenu.classList.remove('active');
      });
    });
  }

  // Header scroll effect (always visible)
  const header = document.querySelector('.header');
  let ticking = false;

  function updateHeader() {
    const currentScrollY = window.scrollY;

    if (currentScrollY > 10) {
      header?.classList.add('header-scrolled');
    } else {
      header?.classList.remove('header-scrolled');
    }

    ticking = false;
  }

  function onScroll() {
    if (!ticking) {
      window.requestAnimationFrame(updateHeader);
      ticking = true;
    }
  }

  window.addEventListener('scroll', onScroll, { passive: true });

  // Cart functionality
  const cartButton = document.getElementById('cart-button');
  const cartBadge = document.getElementById('cart-badge');

  if (cartButton && cartBadge) {
    console.log('🛒 Header cart button found, setting up listeners');
    // Cart button click handler
    cartButton.addEventListener('click', () => {
      console.log('🛒 Cart button clicked');
      if (window.cartManager) {
        console.log('🛒 CartManager found, toggling cart');
        window.cartManager.toggleCart();
      } else {
        console.error('⚠️ CartManager not found on window');
      }
    });

    // Function to setup cart badge subscription with retry logic
    const setupCartBadge = (retryCount = 0) => {
      if (window.cartManager) {
        console.log('🛒 Header: Setting up cart badge subscription');
        window.cartManager.subscribe((state) => {
          console.log('🛒 Header: Badge update - count:', state.itemCount);
          cartBadge.textContent = state.itemCount.toString();
          
          if (state.itemCount > 0) {
            cartBadge.classList.add('has-items');
          } else {
            cartBadge.classList.remove('has-items');
          }
        });
      } else if (retryCount < 50) { // Max 5 seconds of retries
        console.log(`🛒 Header: CartManager not ready, retrying ${retryCount + 1}/50`);
        setTimeout(() => setupCartBadge(retryCount + 1), 100);
      } else {
        console.error('⚠️ Header: CartManager failed to initialize after 5 seconds');
      }
    };
    
    // Setup cart badge subscription
    setupCartBadge();
  }

  // Dropdown menu functionality
  const dropdownToggles = document.querySelectorAll('.dropdown-toggle');
  dropdownToggles.forEach(toggle => {
    toggle.addEventListener('click', (e) => {
      e.stopPropagation();
      const isExpanded = toggle.getAttribute('aria-expanded') === 'true';

      // Close all other dropdowns
      dropdownToggles.forEach(t => {
        if (t !== toggle) {
          t.setAttribute('aria-expanded', 'false');
        }
      });

      // Toggle current dropdown
      toggle.setAttribute('aria-expanded', (!isExpanded).toString());
    });
  });

  // Close dropdowns when clicking outside
  document.addEventListener('click', (e) => {
    const target = e.target;
    if (target && target instanceof Element && !target.closest('.nav-item-dropdown')) {
      dropdownToggles.forEach(toggle => {
        toggle.setAttribute('aria-expanded', 'false');
      });
    }
  });
</script>
